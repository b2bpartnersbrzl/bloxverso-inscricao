<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inscri√ß√£o ‚Äì BloxVerso Con</title>
  <link href="style.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/imask"></script>
  <style>
    .erro-campo {
      color: #ff4c4c;
      font-size: 13px;
      margin-top: -12px;
      margin-bottom: 12px;
      display: none;
      text-align: left;
    }
    input.erro {
      border: 1px solid #ff4c4c !important;
    }
    input:focus, select:focus {
      box-shadow: 0 0 0 2px #ffe60088;
      transition: box-shadow 0.2s ease;
    }
    #mensagem-envio {
      margin-top: 10px;
      font-size: 14px;
      display: none;
    }
    .info-topo {
      text-align: left;
      margin-bottom: 20px;
      font-size: 14px;
      color: #ccc;
    }
  </style>
  <script>
    function validarCPF(cpf) {
      cpf = cpf.replace(/[^\d]+/g, '');
      if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
      let soma = 0, resto;
      for (let i = 1; i <= 9; i++) soma += parseInt(cpf.substring(i - 1, i)) * (11 - i);
      resto = (soma * 10) % 11;
      if (resto === 10 || resto === 11) resto = 0;
      if (resto !== parseInt(cpf.substring(9, 10))) return false;
      soma = 0;
      for (let i = 1; i <= 10; i++) soma += parseInt(cpf.substring(i - 1, i)) * (12 - i);
      resto = (soma * 10) % 11;
      return resto === parseInt(cpf.substring(10, 11));
    }

    function toggleCamposExtras() {
      const idade = parseInt(document.getElementById("idade").value);
      const blocoResponsavel = document.getElementById("bloco_responsavel");
      const campoCpfMaior = document.getElementById("campo_cpf_maior");

      if (!isNaN(idade)) {
        if (idade < 18) {
          blocoResponsavel.style.display = "block";
          campoCpfMaior.style.display = "none";
        } else {
          blocoResponsavel.style.display = "none";
          campoCpfMaior.style.display = "block";
        }
      }
    }

    function limparErros() {
      const campos = document.querySelectorAll("input");
      campos.forEach(campo => campo.classList.remove("erro"));
      const erros = document.querySelectorAll(".erro-campo");
      erros.forEach(e => e.style.display = "none");
    }

    function validarFormulario(event) {
      limparErros();
      document.getElementById("mensagem-envio").style.display = "none";

      const nome = document.getElementById("nome").value.trim();
      const email = document.getElementById("email").value.trim();
      const idade = parseInt(document.getElementById("idade").value.trim());
      const cpfMaior = document.getElementById("cpf_maior").value.trim();
      const nomeResp = document.getElementById("nome_responsavel").value.trim();
      const cpfResp = document.getElementById("cpf_responsavel").value.trim();

      const regexNomeCompleto = /^[A-Za-z√Ä-√ñ√ò-√∂√∏-√ø]+(\\s+[A-Za-z√Ä-√ñ√ò-√∂√∏-√ø]+)+$/;

      let erro = false;

      if (!regexNomeCompleto.test(nome)) {
        erro = true;
        document.getElementById("nome").classList.add("erro");
        document.getElementById("erro_nome").style.display = "block";
      }

      if (!/^[\\w-.]+@[\\w-]+\\.[a-z]{2,}$/.test(email)) {
        erro = true;
        document.getElementById("email").classList.add("erro");
        document.getElementById("erro_email").style.display = "block";
      }

      if (idade >= 18) {
        document.getElementById("campo_cpf_maior").style.display = "block";
        if (!validarCPF(cpfMaior)) {
          erro = true;
          document.getElementById("cpf_maior").classList.add("erro");
          document.getElementById("erro_cpf_maior").style.display = "block";
        }
      }

      if (idade < 18) {
        document.getElementById("bloco_responsavel").style.display = "block";
        if (!regexNomeCompleto.test(nomeResp)) {
          erro = true;
          document.getElementById("nome_responsavel").classList.add("erro");
          document.getElementById("erro_nome_resp").style.display = "block";
        }
        if (!validarCPF(cpfResp)) {
          erro = true;
          document.getElementById("cpf_responsavel").classList.add("erro");
          document.getElementById("erro_cpf_resp").style.display = "block";
        }
      }

      if (erro) {
        event.preventDefault();
        const primeiroErro = document.querySelector(".erro");
        if (primeiroErro) {
          primeiroErro.scrollIntoView({ behavior: "smooth", block: "center" });
        }
      } else {
        document.getElementById("botao-enviar").disabled = true;
        document.getElementById("mensagem-envio").style.display = "block";
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      IMask(document.getElementById("cpf_maior"), { mask: '000.000.000-00' });
      IMask(document.getElementById("cpf_responsavel"), { mask: '000.000.000-00' });
    });
  </script>
</head>
<body>
  <div class="container">
    <img src="assets/logo_forms.png" alt="Logo BloxVerso Con" class="logo" />
    <div class="info-topo">
      üîí Seus dados s√£o usados apenas para personaliza√ß√£o da experi√™ncia no evento.<br />
      ‚è± Leva menos de 1 minuto para preencher.
    </div>
    <h1>Formul√°rio de Inscri√ß√£o</h1>

    <form name="inscricao" method="POST" data-netlify="true" action="/obrigado.html" onsubmit="validarFormulario(event)">
      <input type="hidden" name="form-name" value="inscricao" />

      <label for="nome">Nome completo*</label>
      <input type="text" id="nome" name="nome" required />
      <div id="erro_nome" class="erro-campo">‚ùó Digite seu nome completo.</div>

      <label for="email">E-mail*</label>
      <input type="email" id="email" name="email" required />
      <div id="erro_email" class="erro-campo">‚ùó Digite um e-mail v√°lido.</div>

      <label for="perfil">Perfil do participante*</label>
      <select id="perfil" name="perfil" required>
        <option value="">Selecione...</option>
        <option value="Jogador">Jogador</option>
        <option value="Criador de conte√∫do">Criador de conte√∫do</option>
        <option value="Respons√°vel legal">Respons√°vel legal</option>
        <option value="Outro">Outro</option>
      </select>

      <label for="idade">Idade*</label>
      <input type="number" id="idade" name="idade" required oninput="toggleCamposExtras()" min="1" max="120" />

      <div id="campo_cpf_maior" style="display: none;">
        <label for="cpf_maior">CPF do participante*</label>
        <input type="text" id="cpf_maior" name="cpf_maior" />
        <div id="erro_cpf_maior" class="erro-campo">‚ùó CPF inv√°lido.</div>
      </div>

      <div id="bloco_responsavel" style="display: none;">
        <label for="nome_responsavel">Nome completo do respons√°vel legal*</label>
        <input type="text" id="nome_responsavel" name="nome_responsavel" />
        <div id="erro_nome_resp" class="erro-campo">‚ùó Digite o nome completo do respons√°vel.</div>

        <label for="cpf_responsavel">CPF do respons√°vel legal*</label>
        <input type="text" id="cpf_responsavel" name="cpf_responsavel" />
        <div id="erro_cpf_resp" class="erro-campo">‚ùó CPF do respons√°vel inv√°lido.</div>
      </div>

      <label for="whatsapp">WhatsApp (opcional)</label>
      <input type="text" id="whatsapp" name="whatsapp" />

      <label for="instagram">Instagram (opcional)</label>
      <input type="text" id="instagram" name="instagram" />

      <label for="tiktok">TikTok (opcional)</label>
      <input type="text" id="tiktok" name="tiktok" />

      <label for="roblox">Perfil Roblox (opcional)</label>
      <input type="text" id="roblox" name="roblox" />

      <div class="checkbox-container">
        <label>
          <input type="checkbox" name="consentimento" required />
          Autorizo o uso das informa√ß√µes fornecidas exclusivamente para fins de personaliza√ß√£o da experi√™ncia no evento BloxVerso Con.
        </label>
      </div>

      <button id="botao-enviar" type="submit">Enviar inscri√ß√£o</button>
      <div id="mensagem-envio">‚è≥ Enviando sua inscri√ß√£o‚Ä¶</div>
    </form>
  </div>
</body>
</html>